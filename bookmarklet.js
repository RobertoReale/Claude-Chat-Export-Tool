javascript:!function(){function e(e,t){return t.every(t=>e.classList.contains(t))}function t(e){let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t.toString()}function n(e,t=null){const n=['[data-testid="user-message"]',"div.font-user-message","div.flex.flex-row.gap-2",'[class*="message"]',"div > div:last-child","p"];let o="",r=0;for(const t of n){e.querySelectorAll(t).forEach(e=>{if(e.classList.contains("rounded-full")||e.classList.contains("shrink-0")||e.textContent?.trim().match(/^[A-Z]{1,3}$/)&&0===e.children.length)return;const t=e.textContent?.trim()||"";t.length>3&&t.length>r&&(r=t.length,o=t)})}return(!o||o.length<10)&&(o=e.textContent?.trim()||""),function(e,t=null){if(!e)return"";if(t){const n=new RegExp(`^${t}\\s*`,"g");e=e.replace(n,"")}return(e=(e=(e=(e=e.replace(/^[A-Z]{1,3}\s+/,"")).replace(/^(User:|Claude:)\s*/i,"")).replace(/\b(Share|Copy|Edit|Delete|Modifica|Condividi|Copia|Modifica|Elimina)\b/g,"")).replace(/\d+\/\d+/g,"")).replace(/\s+/g," ").trim()}(o,t)}function o(e){if(!e)return null;let t="",n="";const o=['[class*="tabular-nums"]','[class*="time"]','span:contains("s")','div:contains("s")'];for(const n of o){const o=e.querySelector(n);if(o&&o.textContent.match(/\d+s?/)){t=o.textContent.trim();break}}const r=e.querySelector('[class*="overflow-y-auto"]')||e.querySelector('[class*="overflow"]')||e;return r&&(r.querySelectorAll("p").forEach(e=>{const t=e.textContent.trim();t&&!t.match(/^\d+s?$/)&&(n+=t+"\n\n")}),r.querySelectorAll("ol, ul").forEach(e=>{const t=e.querySelectorAll("li");t.forEach((t,o)=>{const r=t.textContent.trim();r&&("OL"===e.tagName?n+=`${o+1}. ${r}\n`:n+=`- ${r}\n`)}),t.length>0&&(n+="\n")})),n.trim()?{content:n.trim(),time:t}:null}function r(e,t){let n="";const o=new Set,r=e.querySelector("div.font-claude-message")||e.querySelector('[class*="prose"]')||e;return r.querySelectorAll("p, h1, h2, h3, h4, h5, h6, pre, code, ul, ol, blockquote, table").forEach(e=>{if(t&&t.contains(e))return;const r=e.textContent.trim();if(r&&!o.has(r))switch(o.add(r),e.tagName){case"P":r&&(n+=r+"\n\n");break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":const t=parseInt(e.tagName[1]);n+="#".repeat(t)+" "+r+"\n\n";break;case"PRE":const o=e.querySelector("code"),l=o?o.textContent:r;n+="```\n"+l+"\n```\n\n";break;case"CODE":"PRE"!==e.parentElement.tagName&&(n+="`"+r+"`");break;case"LI":const s=e.parentElement;if("OL"===s.tagName){const t=Array.from(s.children).indexOf(e)+1;n+=`${t}. ${r}\n`}else n+=`- ${r}\n`;null===e.nextElementSibling&&(n+="\n");break;case"BLOCKQUOTE":n+="> "+r.replace(/\n/g,"\n> ")+"\n\n"}}),r.querySelectorAll('.katex, [class*="math"]').forEach(e=>{if(t&&t.contains(e))return;const o=e.getAttribute("data-latex")||e.textContent;o&&!n.includes(o)&&(n+=`$${o}$\n\n`)}),n.trim()}console.log("ðŸš€ Starting Complete Claude Chat Export...");try{const l=function(){const e=['button[data-testid="chat-menu-trigger"] div.truncate',"header div.truncate","div.truncate.tracking-tight","button div.truncate",'[class*="truncate"]'];for(const t of e){const e=document.querySelector(t);if(e){const t=e.textContent?.trim();if(t&&t.length>0&&!t.match(/^[A-Z]{1,3}$/))return t}}return"Claude Chat Export"}();console.log(`ðŸ“„ Chat title: ${l}`);const s=function(){const l=[],s=new Set,c=document.querySelectorAll("div"),a=function(){const e=document.querySelectorAll('div[class*="rounded-full"][class*="font-bold"]');for(const t of e){const e=t.textContent?.trim();if(e&&e.match(/^[A-Z]{1,3}$/))return e}const t=document.querySelectorAll("*");for(const e of t){const t=e.textContent?.trim();if(t&&t.match(/^[A-Z]{1,3}$/)&&0===e.children.length)return t}return null}();console.log(`ðŸ“ Analyzing ${c.length} elements...`),a&&console.log(`ðŸ‘¤ Found user initials: ${a}`);for(const i of c){let c=null;if(e(i,["group","relative","inline-flex","bg-bg-300"])||e(i,["group","relative","inline-flex"])&&i.classList.contains("bg-bg-300")){const e=n(i,a);e&&e.length>5&&(c={type:"user",content:e,element:i,contentHash:t(e)},console.log("ðŸ‘¤ Found user message"))}else if(e(i,["group","relative","-tracking-[0.015em]"])||e(i,["group","relative"])&&i.classList.contains("-tracking-[0.015em]")){const e=i.querySelector('[class*="rounded-lg"][class*="border"]');let n=null;e&&e.querySelector('[class*="overflow-y-auto"]')&&(n=o(e));const l=r(i,e);(n||l)&&(c={type:"claude",reasoning:n,response:l,element:i,contentHash:t((n?.content||"")+(l||""))},console.log("ðŸ¤– Found Claude message"+(n?" (with reasoning)":"")))}c&&!s.has(c.contentHash)&&(s.add(c.contentHash),l.push(c))}return console.log(`âœ… Extracted ${l.length} messages total`),0===l.length?(console.warn("âš ï¸ No messages found"),null):(l.sort((e,t)=>e.element.compareDocumentPosition(t.element)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1),l)}();if(!s||0===s.length)return void alert("âŒ No conversation found. Make sure you're on a Claude chat page with messages.");const c=function(e,t){let n=`# ${t}\n\n`;return n+=`*Exported on: ${(new Date).toLocaleString()}*\n\n`,n+=`*Total messages: ${e.length}*\n\n`,n+="---\n\n",e.forEach((t,o)=>{"user"===t.type?n+=`## ðŸ‘¤ User\n\n${t.content}\n\n`:"claude"===t.type&&(n+="## ðŸ¤– Claude\n\n",t.reasoning&&t.reasoning.content&&(n+="<details>\n<summary>ðŸ§  Reasoning",t.reasoning.time&&(n+=` (${t.reasoning.time})`),n+=`</summary>\n\n${t.reasoning.content}\n\n</details>\n\n`),t.response&&(n+=`${t.response}\n\n`)),o<e.length-1&&(n+="---\n\n")}),n}(s,l);console.log("ðŸ“„ Generated markdown:",c.length,"characters"),function(e,t){const n=new Blob([e],{type:"text/markdown;charset=utf-8"}),o=URL.createObjectURL(n),r=document.createElement("a");r.href=o;const l=t.replace(/[^a-zA-Z0-9\s\-_]/g,"").replace(/\s+/g,"-").toLowerCase().substring(0,50);r.download=`${l}-${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.md`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o)}(c,l),console.log("ðŸŽ‰ Export complete!"),alert(`âœ… Successfully exported ${s.length} messages!\nCheck your downloads folder.`)}catch(e){console.error("âŒ Export error:",e),alert("âŒ Export failed. Check the console for details.")}}();
