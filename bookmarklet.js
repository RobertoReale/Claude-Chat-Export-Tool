javascript:!function(){function e(e,t){return!(!e||!e.classList)&&t.every(t=>e.classList.contains(t))}function t(e,o=0,r=!1){if(!e)return"";if(r&&e.nodeType===Node.ELEMENT_NODE&&n(e))return"";const s=e.tagName?.toLowerCase();if(e.nodeType===Node.TEXT_NODE)return e.textContent||"";if(["script","style","noscript"].includes(s))return"";if("pre"===s&&e.querySelector("code")){const t=e.querySelector("code"),n=t.textContent||"",o=function(e){let t=e.parentElement;for(;t;){const e=(t.textContent||"").match(/\b(javascript|python|java|cpp|c\+\+|html|css|sql|bash|shell|json|xml|yaml|markdown|php|ruby|go|rust|typescript|swift|kotlin)\b/i);if(e)return e[1].toLowerCase();t=t.parentElement}const n=e.textContent||"";return n.includes("function")&&n.includes("{")?"javascript":n.includes("def ")&&n.includes(":")?"python":n.includes("public class")||n.includes("import java.")?"java":n.includes("<?php")?"php":n.includes("<html")||n.includes("<!DOCTYPE")?"html":n.includes("SELECT")&&n.includes("FROM")?"sql":n.includes("#!/bin/bash")||n.includes("echo ")?"bash":""}(t);return`\n\`\`\`${o}\n${n}\n\`\`\`\n`}if("code"===s&&"PRE"!==e.parentElement?.tagName)return`\`${e.textContent||""}\``;if("math"===s||e.classList.contains("katex")||e.classList.contains("MathJax"))return function(e){if("MATH"===e.tagName){const t=e.textContent||"";return"block"===e.getAttribute("display")||e.classList.contains("math-display")?`$$${t}$$`:`$${t}$`}if(e.classList.contains("katex")||e.classList.contains("MathJax"))return`$${e.textContent||""}$`;return e.textContent||""}(e);if("br"===s)return"\n";if("p"===s){const n=Array.from(e.childNodes).map(e=>t(e,o+1,r)).join("");return n?`${n}\n\n`:""}if("ul"===s||"ol"===s){const n=Array.from(e.children).filter(e=>"LI"===e.tagName).map((e,n)=>`${"ul"===s?"-":`${n+1}.`} ${t(e,o+1,r).trim()}`).join("\n");return n?`${n}\n\n`:""}if(["h1","h2","h3","h4","h5","h6"].includes(s)){const n=parseInt(s[1]),i=Array.from(e.childNodes).map(e=>t(e,o+1,r)).join("");return`${"#".repeat(n)} ${i.trim()}\n\n`}if("strong"===s||"b"===s){return`**${Array.from(e.childNodes).map(e=>t(e,o+1,r)).join("")}**`}if("em"===s||"i"===s){return`*${Array.from(e.childNodes).map(e=>t(e,o+1,r)).join("")}*`}if("a"===s){const n=e.getAttribute("href"),s=Array.from(e.childNodes).map(e=>t(e,o+1,r)).join("");return n?`[${s}](${n})`:s}if("blockquote"===s){return Array.from(e.childNodes).map(e=>t(e,o+1,r)).join("").split("\n").map(e=>e.trim()?`> ${e}`:">").join("\n")+"\n\n"}return Array.from(e.childNodes).map(e=>t(e,o+1,r)).join("")}function n(t){if(!t||!t.classList||!t.querySelector)return!1;if(e(t,["transition-all","duration-400","ease-out","rounded-lg"])){const e=t.querySelector("button");if(!e)return!1;const n=e.textContent||"";return n.includes("Processo di ragionamento")||n.includes("Thinking")||n.includes("Reasoning")||n.includes("Processing")}return!1}function o(e){const n=e.querySelector("div.overflow-hidden[style]");if(!n)return"";const o=n.getAttribute("style")||"";if(o.includes("height: 0px")||o.includes("opacity: 0"))return"";return t(n.querySelector(".font-claude-response")||n.querySelector('div[class*="text-text-300"]')||n).trim()}function r(e,o){let r;if(o){if(r=e.querySelector("div.flex.flex-row.gap-2"),r){const e=r.querySelectorAll("div, p, span");let t=r,n=0;e.forEach(e=>{const o=e.textContent?.trim()||"";o.length>3&&!o.match(/^[A-Z]{1,3}$/)&&o.length>n&&(n=o.length,t=e)}),n>0&&(r=t)}}else if(r=e.querySelector("div.font-claude-message"),!r){const t=e.querySelectorAll('div[class*="text-text-"]');for(const o of t){let t=o.parentElement,s=!1;for(;t&&t!==e;){if(n(t)){s=!0;break}t=t.parentElement}if(!s){r=o;break}}}r||(r=e);let s=t(r,0,!0).trim();return o&&(s=function(e){return(e=(e=(e=e.replace(/^[A-Z]{1,3}\s+/,"")).replace(/^[A-Z]\s+/,"")).replace(/^(User:|Claude:)\s*/i,"")).trim()}(s)),s=s.replace(/Processo di ragionamento\s*\d+s?/gi,"").trim(),s.replace(/\n{3,}/g,"\n\n")}!function(){console.log("üöÄ Claude Chat Export Tool Starting (Enhanced Version)...");const t=function(){console.log("üîç Starting Claude chat extraction with thinking block support...");const t=[],s=document.querySelectorAll("div");console.log(`üìù Found ${s.length} div elements to analyze`);const i=new Set;for(const c of s)if(c&&c.classList&&c.nodeType===Node.ELEMENT_NODE&&!i.has(c))if(n(c)){const e=o(c);e&&(t.push({type:"thinking",content:e,element:c}),i.add(c),console.log("üß† Found thinking/reasoning block"))}else if(e(c,["group","relative","inline-flex","bg-bg-300"])){const e=r(c,!0);e&&(t.push({type:"user",content:e,element:c}),i.add(c),console.log("üë§ Found user message"))}else if(e(c,["group","relative","-tracking-[0.015em]"])){const e=r(c,!1);e&&(t.push({type:"claude",content:e,element:c}),i.add(c),console.log("ü§ñ Found Claude message"))}return console.log(`‚úÖ Extracted ${t.length} messages total`),0===t.length?(console.warn("‚ö†Ô∏è No messages found. The page structure might have changed."),null):(t.sort((e,t)=>e.element.compareDocumentPosition(t.element)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1),t.map(e=>"thinking"===e.type?`<details>\n<summary>üß† Processo di ragionamento</summary>\n\n${e.content}\n\n</details>`:"user"===e.type?`**User:** ${e.content}`:`**Claude:** ${e.content}`).join("\n\n---\n\n"))}();t?(console.log("üìÑ Generated markdown:",t.length,"characters"),function(e){const t=new Blob([e],{type:"text/markdown"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download=`claude-chat-${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.md`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)}(t),console.log("üéâ Export complete with thinking blocks!"),alert("‚úÖ Conversation exported successfully with thinking blocks!")):alert("‚ùå No conversation found. Make sure you're on a Claude chat page.")}()}();
